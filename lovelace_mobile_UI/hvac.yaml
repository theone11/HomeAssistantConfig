# lovelace_gen

#--------------------------------------------------------------------------------------------------
# General
#--------------------------------------------------------------------------------------------------
{% set days = [("sunday"   , "1", "Sun", "ראשון"),
               ("monday"   , "2", "Mon", "שני"),
               ("tuesday"  , "3", "Tue", "שלישי"),
               ("wednesday", "4", "Wed", "רביעי"),
               ("thursday" , "5", "Thu", "חמישי"),
               ("friday"   , "6", "Fri", "שישי"),
               ("saturday" , "7", "Sat", "שבת")] %}

#--------------------------------------------------------------------------------------------------
# HVAC
#--------------------------------------------------------------------------------------------------
#                 entity     , left, top
{% set hvacs = [("livingroom", 53 , 92),
                ("hallway"   , 28 , 92)] %}

#########################################################
#########################################################
#########################################################
# types: DSD     - Day Start Duration
#        DS      - Day Start
#        S_HVAC  - Start HVAC

{% macro create_schedulers_popup(entity, scheduler_type) -%}
  {% if (scheduler_type == "S_HVAC") %}
  {% set num_schedulers = 4 %}
  {% set schedulers = ['1', '2', '3', '4'] %}
  {% else %}
  {% set num_schedulers = 2 %}
  {% set schedulers = ['1', '2'] %}
  {% endif %}
    {% for s in schedulers %}
    - type: grid
      columns: 1
      square: false
      title: Schedule {{ s }}
      cards:
        {% if (scheduler_type == "DSD") or (scheduler_type == "DS") %}
        - type: grid
          columns: 7
          square: false
          cards:
            {% for day, number, name, name_he in days %}
            - type: custom:button-card
              entity: input_boolean.{{ entity }}_day_{{ day }}{{ s }}
              name: {{ name_he }}
              icon: mdi:numeric-{{ number }}-box-outline
              show_name: true
              show_icon: true
              show_state: false
            {% endfor %}
        {% endif %}
        - type: entities
          # icon: 'mdi:timer-outline'
          show_header_toggle: false
          state_color: false
          # title: Schedule {{ s }}
          entities:
            {% if (scheduler_type == "DSD") or (scheduler_type == "DS") %}
            # - type: section
            - entity: input_boolean.{{ entity }}_scheduler_enable{{ s }}
            - type: 'custom:time-picker-card'
              entity: input_datetime.{{ entity }}_start_time{{ s }}
              layout:
                embedded: true
                name: inside
                align_controls: right
              {% endif %}
            {% if (scheduler_type == "S_HVAC") %}
            # - type: section
            - entity: input_boolean.{{ entity }}_scheduler_enable{{ s }}
            - type: custom:silent-remotes-card
              entity: climate.hvac_{{ entity }}_virtual_{{ s }}
              theme: light
              title: "Scheduler {{ s }}"
              remoteType: ac
            # - type: 'custom:simple-thermostat'
            #   entity: climate.{{ entity }}_virtual_{{ s }}
            #   header: false
            #   setpoints:
            #   layout:
            #     step: row
            #     mode:
            #       names: false
            #       icons: true
            #       headings: false
            #   decimals: 0
            #   step_size: 1
            #   hide:
            #     state: true
            #     temperature: true
            #   control:
            #     hvac: true
            #     fan:
            #       "low":
            #         icon: mdi:fan-speed-1
            #       "mid":
            #         icon: mdi:fan-speed-2
            #       "high":
            #         icon: mdi:fan-speed-3
            - type: 'custom:time-picker-card'
              entity: input_datetime.{{ entity }}_start_time{{ s }}
              layout:
                embedded: true
                name: inside
                align_controls: right
            {% endif %}
            {% if scheduler_type == "DSD" %}
            - type: section
            - type: 'custom:slider-entity-row'
              entity: input_number.{{ entity }}_timer_duration{{ s }}
              hide_state: false
            {% endif %}
    {% endfor %}
{%- endmacro %}

title: HVAC
path: hvac
icon: 'mdi:air-conditioner'
badges: []
cards:
  - type: grid
    columns: 1
    square: false
    cards:
    - type: grid
      columns: 2
      square: false
      cards:
      {% for entity, left, top in hvacs %}
        - type: custom:silent-remotes-card
          entity: climate.hvac_{{ entity }}
          theme: light
          title: {{ entity.capitalize() }} AC
          remoteType: ac
      {% endfor %}

  {% for entity, left, top in hvacs %}
    - type: markdown
      content: "# {{ entity }} Schedulers"
    {{ create_schedulers_popup("hvac_" ~ entity, "S_HVAC") }}
  {% endfor %}
